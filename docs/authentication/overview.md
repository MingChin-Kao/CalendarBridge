# 認證方式概覽

本指南將幫助您了解 CalendarBridge 支援的認證方式，並選擇最適合您需求的方案。

## 開始之前：Google Cloud 專案設置

無論選擇哪種認證方式，都需要先建立 Google Cloud 專案並啟用 Calendar API。

### 步驟 1: 建立 Google Cloud 專案

1. 前往 [Google Cloud Console](https://console.cloud.google.com/)
2. 點擊頁面上方的專案下拉選單
3. 點擊「新增專案」按鈕
4. 填寫專案資訊：
   - **專案名稱**: `CalendarBridge`（或您偏好的名稱）
   - **組織**: 保持預設值
   - **位置**: 保持預設值
5. 點擊「建立」按鈕
6. 等待專案建立完成（通常需要幾秒鐘）
7. **重要**: 記下專案 ID，稍後設置服務帳號時會用到

> 💡 **專案 ID 與專案名稱不同**：專案 ID 是系統自動生成的唯一識別碼，格式通常為 `project-name-123456`

### 步驟 2: 啟用 Google Calendar API

1. 確保已選擇正確的專案（查看頁面上方的專案名稱）
2. 在左側導航欄中，點擊「APIs & Services」→「Library」
3. 在搜尋框中輸入「Google Calendar API」
4. 點擊搜尋結果中的「Google Calendar API」
5. 點擊「啟用」按鈕
6. 等待 API 啟用完成

### 步驟 3: 驗證設置

完成上述步驟後，您應該能看到：
- 在「APIs & Services」→「Enabled APIs」中看到 Google Calendar API
- 專案儀表板顯示您的專案資訊

---

## 認證方式比較

CalendarBridge 支援兩種認證方式，各有優缺點：

| 特性 | 服務帳號認證 | OAuth 認證 |
|------|------------|-----------|
| **推薦用途** | 🏢 生產環境、Docker 部署 | 👨‍💻 個人開發、測試 |
| **使用者互動** | ❌ 無需使用者授權 | ✅ 需要瀏覽器授權 |
| **Token 管理** | ✅ 無 Token 過期問題 | ⚠️ Token 可能過期需重新授權 |
| **行事曆存取** | ⚠️ 需要明確分享行事曆 | ✅ 可存取個人所有行事曆 |
| **安全性** | ✅ 服務帳號金鑰管理 | ✅ OAuth 標準流程 |
| **維護成本** | ✅ 低，設定後免維護 | ⚠️ 需定期檢查授權狀態 |
| **Docker 友善** | ✅ 完全支援 | ⚠️ 需要預先授權 |
| **自動化部署** | ✅ 適合 | ⚠️ 不適合 |

### 詳細對比

#### 服務帳號認證（推薦生產環境使用）

**優點**：
- ✅ 完全自動化，無需使用者互動
- ✅ 金鑰長期有效，無 Token 過期問題
- ✅ 適合 Docker 和容器化部署
- ✅ 適合定時任務和背景服務
- ✅ 安全性高，權限可精確控制

**缺點**：
- ⚠️ 需要手動分享行事曆給服務帳號
- ⚠️ 無法直接存取個人預設行事曆
- ⚠️ 初次設置步驟較多

**適用場景**：
- 🐳 Docker 容器部署
- 🔄 自動化同步服務
- 🏢 生產環境長期運行
- 📊 多使用者共用行事曆

#### OAuth 認證

**優點**：
- ✅ 設置相對簡單
- ✅ 可直接存取個人所有行事曆
- ✅ 無需手動分享行事曆
- ✅ 適合快速測試和開發

**缺點**：
- ⚠️ 需要瀏覽器互動完成授權
- ⚠️ Token 可能過期需重新授權
- ⚠️ 不適合完全自動化的環境
- ⚠️ Docker 部署需要額外處理

**適用場景**：
- 👨‍💻 個人開發測試
- 🔬 功能驗證
- 💻 本地運行
- 🚀 快速原型開發

---

## 如何選擇？

### 我應該選擇服務帳號認證如果：

- ✅ 您計劃使用 Docker 部署
- ✅ 您需要長期穩定運行
- ✅ 您希望完全自動化，無需人工介入
- ✅ 您可以接受手動分享行事曆的步驟

**👉 繼續閱讀**：[服務帳號設置指南](service_account.md)

### 我應該選擇 OAuth 認證如果：

- ✅ 您只是想快速測試功能
- ✅ 您在本地開發環境運行
- ✅ 您需要存取多個個人行事曆
- ✅ 您可以接受偶爾需要重新授權

**👉 繼續閱讀**：[OAuth 認證指南](oauth.md)

---

## 常見問題

### Q: 我需要啟用計費嗎？

A: 對於 CalendarBridge 的基本使用，Google Calendar API 在免費額度內通常已足夠。Google Calendar API 每天有 1,000,000 次查詢的免費額度，對於個人或小型團隊使用綽綽有餘。

### Q: 可以在現有專案中使用嗎？

A: 可以，您可以在現有的 Google Cloud 專案中啟用 Google Calendar API，只要確保該專案有足夠的權限即可。

### Q: 如何找到我的專案 ID？

A: 在 Google Cloud Console 的儀表板上方，專案名稱旁邊會顯示專案 ID，或者在「專案設定」頁面中可以找到。

### Q: 兩種認證方式可以切換嗎？

A: 可以。您隨時可以修改 `config/settings.yaml` 中的 `auth_type` 設定來切換認證方式。只需確保相應的認證檔案已正確配置即可。

### Q: 哪種方式更安全？

A: 兩種方式的安全性相當，關鍵在於金鑰檔案的管理：
- **服務帳號**：需要妥善保管 `service_account.json` 檔案
- **OAuth**：需要妥善保管 `credentials.json` 和 `token.json` 檔案

建議將所有認證檔案加入 `.gitignore`，並在生產環境使用環境變數或密碼管理工具。

### Q: 可以同時使用兩種認證方式嗎？

A: 技術上可以，但不建議。CalendarBridge 在每次運行時只會使用 `settings.yaml` 中指定的一種認證方式。建議根據您的使用場景選擇一種方式並保持一致。

---

## 下一步

完成 Google Cloud 專案設置後，請根據您的選擇繼續：

- **生產環境/Docker 部署** → [服務帳號設置指南](service_account.md)
- **個人開發/測試** → [OAuth 認證指南](oauth.md)

## 相關文件

- [快速開始指南](../quickstart.md) - 快速體驗 CalendarBridge
- [配置說明](../reference/configuration.md) - 詳細的配置選項
- [疑難排解](../reference/troubleshooting.md) - 認證相關問題解決
